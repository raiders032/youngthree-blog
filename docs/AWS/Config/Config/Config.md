---
title: "Config"
description: "AWS Config 완벽 가이드: 리소스 관리부터 규정 준수까지: AWS Config의 핵심 기능과 활용 방법을 상세히 설명합니다. 리소스 구성 관리, 규칙 설정, 자동 수정 기능을 통한 규정 준수 유지 방법과 실제 사용 사례를 다룹니다."
tags: ["AWS_CONFIG", "AWS", "CLOUD", "DEVOPS", "IAM", "EC2", "S3", "SNS", "SECURITY", "AUTOMATION"]
keywords: ["AWS Config", "AWS 설정", "리소스 관리", "규정 준수", "구성 관리", "클라우드 관리", "보안 설정", "자동화", "모니터링", "감사", "컨피그", "AWS 구성", "클라우드 거버넌스", "리소스 추적", "보안 규정", "컴플라이언스", "설정 변경 추적", "자동 수정", "AWS 모니터링", "클라우드 보안"]
draft: false
hide_title: true
---

## 1 AWS Config 소개

- AWS Config는 AWS 계정 내의 AWS 리소스 구성에 대한 상세한 뷰를 제공하는 서비스입니다.
- 이 서비스를 통해 리소스 간의 관계, 과거 구성, 시간에 따른 구성 변화를 파악할 수 있습니다.
- AWS Config는 EC2 인스턴스, EBS 볼륨, 보안 그룹, VPC 등 다양한 AWS 리소스를 지원합니다.



## 2 AWS Config의 주요 기능: 리소스 관리

### 2.1 리소스 기록 설정

- AWS Config를 설정할 때, 어떤 리소스 유형을 기록할지 지정할 수 있습니다.
- 모든 리소스를 기록하거나 특정 리소스 유형만 선택적으로 기록할 수 있습니다.
- 지원되는 리소스 유형에는 EC2 인스턴스, EBS 볼륨, 보안 그룹, VPC, IAM 사용자 등이 포함됩니다.



### 2.2 구성 스냅샷과 이력

- **구성 스냅샷**:
	- 구성 스냅샷은 특정 시점의 AWS 리소스 구성 상태를 캡처한 것입니다.
	- 이는 리소스의 모든 구성 세부 정보를 포함하는 JSON 형식의 파일입니다.
	- 스냅샷을 통해 특정 시점의 전체 인프라 상태를 파악할 수 있습니다.
- **구성 이력**:
	- 구성 이력은 시간에 따른 리소스 구성 변경 사항을 기록한 것입니다.
	- 각 변경 사항은 구성 항목(Configuration Item)이라고 불리는 개별 레코드로 저장됩니다.
	- 이를 통해 리소스의 변경 사항을 시간순으로 추적할 수 있습니다.



### 2.3 S3 버킷 설정

- AWS Config는 구성 스냅샷과 이력을 지정된 S3 버킷에 저장합니다.
- 이 S3 버킷은 다음과 같은 용도로 사용됩니다:
	- 정기적인 구성 스냅샷 저장
	- 구성 이력 파일 저장
	- AWS Config 콘솔에서 조회할 수 있는 데이터 소스로 활용
- S3 버킷 설정 시 고려사항:
	- 버킷은 AWS Config를 설정하는 동일한 리전에 있어야 합니다.
	- 버킷에 대한 적절한 권한을 AWS Config에 부여해야 합니다.
	- 데이터의 중요성을 고려하여 버킷에 적절한 보안 설정(예: 암호화)을 적용해야 합니다.



### 2.4 SNS 주제 설정

- AWS Config는 구성 변경 사항을 Amazon SNS(Simple Notification Service) 주제로 스트리밍할 수 있습니다.
- 이를 통해 실시간으로 구성 변경 알림을 받을 수 있습니다.
- SNS 주제 설정 시 고려사항:
	- 알림을 받을 대상(이메일, Lambda 함수, SQS 큐 등)을 설정해야 합니다.
	- 알림의 형식과 빈도를 구성할 수 있습니다.
	- 중요한 변경 사항에 대해서만 알림을 받도록 필터링할 수 있습니다.



### 2.5 AWS Config에 필요한 권한 설정

- AWS Config가 리소스를 기록하고 S3에 데이터를 저장하며 SNS로 알림을 보내기 위해서는 적절한 IAM 권한이 필요합니다.
- 일반적으로 다음과 같은 권한이 필요합니다:
	- 리소스 구성을 읽을 수 있는 권한
	- S3 버킷에 데이터를 쓸 수 있는 권한
	- SNS 주제로 메시지를 발행할 수 있는 권한
- AWS Config 설정 시 필요한 권한을 가진 IAM 역할을 생성하고 이를 AWS Config에 연결해야 합니다.



### 2.6 구성 레코더 설정

- 구성 레코더는 AWS Config가 지정된 리소스 유형의 구성 변경을 감지하고 기록하는 방식을 정의합니다.
- 구성 레코더 설정 시 다음 사항을 지정할 수 있습니다:
	- 기록할 리소스 유형
	- 글로벌 리소스(예: IAM 리소스) 포함 여부
	- 리소스 기록 빈도



## 3 AWS Config 규칙을 통한 리소스 평가

- AWS Config 규칙을 사용하여 AWS 리소스의 구성 설정을 평가할 수 있습니다.
- AWS는 사용자 정의가 가능한 관리형 규칙을 제공합니다.
- 규칙 평가 결과는 준수(COMPLIANT), 비준수(NON_COMPLIANT), 오류(ERROR), 해당 없음(NOT_APPLICABLE) 중 하나입니다.
- 규칙의 종류는 아래와 같습니다.
  - AWS Managed Rules: AWS에서 사전 정의하고 관리하는 규칙들입니다.
  - Cutom Rules: AWS Lambda 함수를 사용하여 직접 정의하는 규칙입니다.


### 3.1 사용자 정의 규칙(Cutom Rule)

- AWS Lambda를 사용하여 사용자 정의 규칙을 만들 수 있습니다.
- 예: EBS 디스크가 gp2 유형인지, EC2 인스턴스가 t2.micro 유형인지 평가

### 3.2 AWS Managed Rules

- AWS에서 사전 정의하고 관리하는 규칙들입니다.
- [ManagedRule.md](../ManagedRule/ManagedRule.md) 참고

### 3.3 규칙 평가 및 트리거

- 규칙은 구성 변경 시 또는 정기적으로 평가될 수 있습니다.
- AWS Config 규칙은 액션을 방지하지 않고, 규정 준수 여부만 평가합니다.
- 규칙 평가에는 비용이 발생합니다.

## 4 규칙의 자동 수정 및 알림

### 4.1 자동 수정

- SSM Automation Documents를 사용하여 비준수 리소스를 자동으로 수정할 수 있습니다.
- AWS 관리형 또는 사용자 정의 Automation Documents를 사용할 수 있습니다.
- Lambda 함수를 호출하는 Automation Documents를 생성할 수 있습니다.



### 4.2 알림

- EventBridge를 사용하여 비준수 상태의 리소스에 대한 알림을 트리거할 수 있습니다.
- SNS를 통해 구성 변경 및 준수 상태 알림을 받을 수 있습니다.



## 5 CloudWatch vs CloudTrail vs Config

- **CloudWatch**: 성능 모니터링, 이벤트 및 경고, 로그 분석
- **CloudTrail**: API 호출 기록, 특정 리소스에 대한 트레일 정의
- **Config**: 구성 변경 기록, 규정 준수 평가, 구성 변경 및 준수 상태 타임라인 제공



## 6 실제 사용 시나리오: 태그 기반 EC2 인스턴스 관리

### 6.1 시나리오 설명

- 한 회사의 SysOps 관리자가 AWS 계정의 보안과 규정 준수를 유지 관리하고 있습니다.
- 회사 정책에 따라 모든 EC2 인스턴스에는 부서 태그가 있어야 합니다.
- 부서 태그가 없는 EC2 인스턴스는 실시간으로 종료되어야 합니다.



### 6.2 해결 방안

- AWS Config 규칙 생성
	- `required-tags` 관리형 규칙을 사용하여 비준수 리소스를 식별합니다.
	- 이 규칙은 특정 태그(여기서는 '부서' 태그)가 없는 EC2 인스턴스를 비준수로 표시합니다.
- 자동 수정 구성
	- `AWS-TerminateEC2Instance` 자동화 문서를 사용하여 자동 수정을 구성합니다.
	- 이 자동화 문서는 비준수로 표시된 EC2 인스턴스를 자동으로 종료합니다.



### 6.3 구현 단계

- AWS Config 콘솔에서 새 규칙 생성
    - 'required-tags' 관리형 규칙 선택
    - 규칙 파라미터 설정: `tag1Key=department`
- 자동 수정 설정
    - 규칙 세부 정보 페이지에서 '수정 작업' 선택
    - 'AWS-TerminateEC2Instance' 자동화 문서 선택
    - 필요한 IAM 역할 및 권한 설정
- 규칙 활성화 및 모니터링
    - 규칙을 활성화하고 평가 결과 모니터링
    - 비준수 인스턴스가 자동으로 종료되는지 확인



### 6.4 이점

- 자동화된 규정 준수: 수동 개입 없이 회사 정책을 자동으로 적용할 수 있습니다.
- 실시간 대응: 비준수 인스턴스를 즉시 감지하고 조치를 취할 수 있습니다.
- 감사 및 보고: AWS Config를 통해 모든 변경 사항과 조치를 추적하고 보고할 수 있습니다.



## 7 결론

- AWS Config는 AWS 리소스의 구성을 관리하고 규정 준수를 유지하는 강력한 도구입니다.
- 자동화된 규칙과 수정 작업을 통해 보안 정책을 효과적으로 적용할 수 있습니다.
- 실제 사용 시나리오에서 볼 수 있듯이, AWS Config는 복잡한 규정 준수 요구 사항을 간단하게 해결할 수 있습니다.
- 지속적인 모니터링과 자동화된 대응을 통해 AWS 환경의 보안과 규정 준수를 크게 향상시킬 수 있습니다.