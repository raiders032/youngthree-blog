## 1 DynamoDB

- Amazon DynamoDB는 어떤 규모에서든 대기 시간이 일관되게 10밀리초 미만이어야 하는 모든 애플리케이션을 위한, 빠르고 유연한 NoSQL 데이터베이스 서비스입니다.
- 또한, 완전관리형 클라우드 데이터베이스로서 문서 모델과 키 값 스토어 모델을 모두 지원합니다.
- 유연한 데이터 모델, 안정적인 성능, 처리 용량 자동 크기 조정 기능은 모바일, 웹, 게임, 광고 기술, IoT, 그 외 많은 애플리케이션에 매우 적합합니다.
- DynamoDB는 사용자가 대규모 인프라를 직접 관리하지 않고도 수 백만 명의 사용자를 지원할 수 있는 애플리케이션을 구축할 수 있게 해줍니다.
    - 데이터베이스는 사용량에 따라 자동으로 확장되며, 사용자는 물리적인 하드웨어를 준비하거나 데이터베이스 성능을 수동으로 모니터링할 필요가 없습니다.



### 1.1 주요 특징

- 고성능 및 확장성
    - DynamoDB는 자동 스케일링 기능을 통해 트래픽 변동에 맞게 용량을 자동으로 조정합니다.
    - 이를 통해 애플리케이션은 변동하는 데이터 접근 패턴에도 불구하고 일관된 성능을 유지할 수 있습니다.
- 완전 관리형 서비스
    - 인프라 유지 관리, 백업, 복구, 패치 적용 등의 작업은 AWS에 의해 자동으로 처리됩니다.
    - 이로 인해 개발자는 애플리케이션 개발에 더 집중할 수 있습니다.
- 보안
    - DynamoDB는 데이터를 암호화하여 저장하며, AWS Identity and Access Management(IAM)을 통해 세밀한 접근 제어를 지원합니다.
- 다중 리전 복제
    - 글로벌 분산 애플리케이션을 지원하기 위해, DynamoDB는 자동으로 데이터를 여러 AWS 리전에 걸쳐 복제할 수 있습니다.
    - 이는 데이터의 가용성과 내구성을 크게 향상시킵니다.
- 스트림
    - DynamoDB Streams를 사용하면 변경 데이터 캡처(CDC)를 통해 데이터베이스 업데이트를 실시간으로 캡처하고 이를 다른 애플리케이션과 동기화할 수 있습니다.



## 2 작동 방식

- Amazon DynamoDB는 모든 규모에서 고성능 애플리케이션을 실행하도록 설계된 완전관리형의 서버리스 키-값 NoSQL 데이터베이스입니다.
- DynamoDB는 기본 제공 보안, 지속적인 백업, 자동화된 다중 리전 복제, 인 메모리 캐시 및 데이터 가져오기/내보내기 도구를 제공합니다.



## 3 Point-in-time recovery (PITR)

- Amazon DynamoDB는 포인트 인 타임 복구(PITR)를 사용하여 테이블 데이터를 연속적으로 백업할 수 있습니다.
- PITR을 활성화하면 DynamoDB는 35일 동안 초 단위로 테이블 데이터를 자동으로 백업합니다.
- PITR은 실수로 인한 쓰기 및 삭제로부터 데이터를 보호합니다.
- 예를 들어, 테스트 스크립트가 실수로 프로덕션 DynamoDB 테이블에 쓰기를 하거나, 누군가 실수로 "DeleteItem" 호출을 하는 경우, PITR을 통해 복구할 수 있습니다.
- PITR을 사용하면 수백 테라바이트의 데이터를 가진 테이블도 백업할 수 있으며, 프로덕션 애플리케이션의 성능이나 가용성에 영향을 주지 않습니다.
- 최근 35일 이내에 삭제된 테이블을 복구하고 삭제 직전 상태로 복원할 수 있습니다.
- AWS Management Console에서 한 번의 클릭으로 PITR을 활성화하거나 간단한 API 호출로 활성화할 수 있습니다.



## 4 DynamoDB 기초

- DynamoDB는 테이블로 구성됩니다.
- 각 테이블에는 기본 키(Primary Key)가 있으며, 이는 생성 시 결정해야 합니다.
- 각 테이블에는 무한한 수의 항목(행)을 가질 수 있습니다.
- 각 항목은 속성(Attributes)을 가지며, 이는 시간이 지남에 따라 추가될 수 있고, null 값을 가질 수 있습니다.
- 항목의 최대 크기는 400KB입니다.
- 지원되는 데이터 유형:
    - 스칼라 타입: String, Number, Binary, Boolean, Null
    - 문서 타입: List, Map
    - 세트 타입: String Set, Number Set, Binary Set



## 5 DynamoDB 글로벌 테이블

- 여러 리전에서 낮은 지연 시간으로 접근할 수 있는 DynamoDB 테이블을 만듭니다.
- 액티브-액티브 복제를 제공합니다.
	- **액티브-액티브 복제**는 여러 리전에 있는 데이터베이스 인스턴스가 동시에 읽기 및 쓰기를 처리할 수 있는 구조를 의미합니다.
	- 사용자가 미국 리전에서 데이터를 작성하면, 그 데이터는 자동으로 유럽 및 아시아 리전의 테이블과 동기화됩니다.
- 이를 통해 사용자는 전 세계 어디에서나 빠르게 데이터에 접근할 수 있습니다.
- 애플리케이션은 모든 리전에서 테이블에 대해 읽기 및 쓰기를 수행할 수 있습니다.
- 사전 요구 사항으로 DynamoDB Streams를 활성화해야 합니다
- **장점**
	- **고가용성**: 한 리전에 장애가 발생해도 다른 리전에서 계속 서비스를 제공할 수 있습니다.
	- **낮은 지연 시간**: 사용자와 가까운 리전에서 데이터에 접근할 수 있어 응답 시간이 빨라집니다.
	- **글로벌 확장성**: 여러 리전에 걸쳐 데이터베이스를 확장하여 글로벌 사용자에게 빠르고 일관된 서비스를 제공합니다.



## 6 DynamoDB – Time To Live (TTL)

- Time To Live (TTL)는 DynamoDB 테이블의 항목을 만료 시간이 지나면 자동으로 삭제하는 기능입니다.
- TTL 기능은 추가 비용 없이 사용할 수 있으며, 쓰기 용량 단위(WCU)를 소비하지 않습니다.



### 6.1 TTL 구현 방법

- TTL 속성은 반드시 "Number" 데이터 타입이어야 하며, "Unix Epoch 타임스탬프" 값을 사용해야 합니다.
- 만료된 항목은 만료 시점으로부터 48시간 이내에 삭제됩니다.



### 6.2 만료된 항목의 처리

- 만료되었지만 아직 삭제되지 않은 항목은 읽기/쿼리/스캔 작업에서 여전히 나타날 수 있습니다.
	- 이러한 항목을 제외하고 싶다면, 애플리케이션 레벨에서 필터링해야 합니다.
- 만료된 항목은 로컬 보조 인덱스(LSI)와 글로벌 보조 인덱스(GSI)에서도 삭제됩니다.
- 만료된 각 항목에 대한 삭제 작업은 DynamoDB Streams에 기록됩니다.
	- 이를 통해 필요한 경우 만료된 항목을 복구할 수 있습니다.



### 6.3 TTL의 사용 사례

- 저장된 데이터를 줄이기 위해 현재 항목만 유지하고 오래된 데이터는 자동으로 삭제합니다.
- 규제 요구사항을 준수하기 위해 특정 기간이 지난 데이터를 자동으로 삭제합니다.
- 세션 데이터, 이벤트 로그, 임시 데이터 등을 효율적으로 관리합니다.