## 1 EC2

- Amazon Elastic Compute Cloud(Amazon EC2)는 AWS에서 제공하는 클라우드 컴퓨팅 서비스로, 사용자가 원하는 만큼의 가상 서버를 생성하고 관리할 수 있게 해줍니다.
- 물리적인 하드웨어를 구입하고 유지보수할 필요 없이, 클릭 몇 번으로 필요한 만큼의 서버를 생성할 수 있습니다.
- 이러한 유연성 덕분에 트래픽 급증이나 새로운 애플리케이션의 배포에도 신속하게 대응할 수 있습니다.



## 2 주요 기능

- **다양한 인스턴스 타입**
    - EC2는 다양한 인스턴스 타입을 제공하여, CPU, 메모리, 스토리지 및 네트워크 성능을 사용자 요구에 맞게 조정할 수 있습니다.
    - 일반적인 용도에서부터 메모리 집약적, 컴퓨팅 집약적 워크로드에 이르기까지 다양한 인스턴스 타입이 있습니다.
- **자동 확장(Auto Scaling)**
    - EC2 Auto Scaling을 사용하면, 트래픽 변화에 따라 인스턴스 수를 자동으로 조정할 수 있습니다.
    - 이를 통해 비용 효율성을 유지하면서도 성능을 보장할 수 있습니다.
- **로드 밸런싱**
    - AWS Elastic Load Balancing(ELB)을 통해 여러 인스턴스에 걸쳐 트래픽을 자동으로 분산시킬 수 있습니다.
    - 이를 통해 애플리케이션의 가용성과 확장성을 향상시킬 수 있습니다.
- **보안**
    - EC2는 가상 프라이빗 클라우드(VPC), 보안 그룹 및 네트워크 ACL을 통해 높은 수준의 보안 제어를 제공합니다.
    - 이를 통해 인스턴스 접근을 제어하고, 데이터 전송을 암호화할 수 있습니다.
- **유연한 요금제**
    - EC2는 온디맨드, 예약 인스턴스, 스팟 인스턴스 등 다양한 요금제를 제공하여 비용 효율적인 리소스 관리를 지원합니다.
    - 사용량에 따라 요금을 지불하거나, 예약 인스턴스를 통해 장기적으로 비용을 절감할 수 있습니다.



## 3 유연한 요금제

- Amazon EC2는 다양한 요금제를 제공하여 사용자의 요구와 예산에 맞게 리소스를 관리할 수 있도록 돕습니다.
- 각 요금제는 고유한 장점과 용도를 가지고 있습니다.



### 3.1 온디맨드 인스턴스

- 사용한 만큼만 비용을 지불하는 요금제입니다.
- 장기 계약이나 선불 결제가 필요 없으며, 필요할 때 즉시 인스턴스를 시작하고 중지할 수 있습니다.
- 예측할 수 없는 워크로드, 개발 및 테스트 환경에 적합합니다.
- 유연성과 간편성 덕분에 초기 투자 비용이 없습니다.
- 단, 장기적으로 사용하면 비용이 높아질 수 있습니다.



### 3.2 예약 인스턴스

- 예약 인스턴스는 온디맨드 요금과 비교하여 최대 72%까지 할인된 요금을 제공합니다.
- 1년 또는 3년의 계약 기간을 선택할 수 있으며, 다른 기간 옵션은 제공되지 않습니다.
- 표준 예약 인스턴스와 컨버터블 예약 인스턴스 두 가지 옵션을 제공합니다.
- 장기적으로 안정적인 워크로드, 고정된 사용량을 가진 경우 적합합니다.
- 장기 계약이 필요하며, 사용하지 않는 경우에도 비용이 발생할 수 있습니다.



#### 3.2.1 표준 RI 및 컨버터블 RI 비교

- **표준 예약 인스턴스**: 최대 72%의 할인 혜택을 제공하며, 고정된 사용량에 적합합니다.
- **컨버터블 예약 인스턴스**: 최대 54%의 할인 혜택을 제공하며, 인스턴스 속성(인스턴스 패밀리, 운영 체제, 테넌시, 결제 옵션)을 변경할 수 있습니다.

|특성|표준 RI|컨버터블 RI|
|---|---|---|
|약정 기간 (온디맨드 대비 평균 할인율)|1년(40%), 3년(60%)|1년(31%), 3년(54%)|
|가용 영역, 인스턴스 크기 변경|예|예|
|인스턴스 패밀리, 운영 체제 변경|아니요|예|
|가격 인하 혜택|예|예|



### 3.3 스팟 인스턴스

- 스팟 인스턴스는 AWS의 여유 용량을 활용하여 온디맨드 가격보다 저렴하게 사용할 수 있는 요금제입니다.
- 최대 90%까지 비용을 절감할 수 있으며, 미사용 EC2 인스턴스를 요청하여 비용을 절감합니다.
- 애플리케이션 실행 시간을 유연하게 조정할 수 있고, 애플리케이션을 중단할 수 있는 경우에 적합합니다.
- 스팟 인스턴스는 데이터 분석, 배치 작업, CI/CD 파이프라인, 고성능 컴퓨팅(HPC) 작업 등에 활용될 수 있습니다.
- 단, 인스턴스가 예고 없이 종료될 수 있어 중요하지 않은 작업에만 적합합니다.



#### 3.3.1 맥스 스팟 프라이스 (Max Spot Price)

- 스팟 인스턴스를 요청할 때, 사용자는 최대 스팟 가격(Max Spot Price)을 설정할 수 있습니다.
- 최대 스팟 가격은 사용자가 지불할 의향이 있는 최대 시간당 요금입니다.
- AWS 스팟 가격은 변동성이 있으며, 수요와 공급에 따라 실시간으로 변경됩니다.
- 만약 설정한 최대 스팟 가격이 현재 스팟 가격보다 낮으면, 인스턴스는 종료됩니다.
- 최대 스팟 가격을 설정함으로써 비용을 통제할 수 있으며, 예산 초과를 방지할 수 있습니다.



#### 3.3.2 스팟 인스턴스의 사용 사례

- **대규모 데이터 처리**: 대규모 데이터 분석, 빅데이터 처리, 배치 처리 작업 등에 스팟 인스턴스를 활용하여 비용을 절감할 수 있습니다.
- **CI/CD 파이프라인**: 지속적 통합 및 지속적 배포(CI/CD) 파이프라인의 일환으로 테스트 및 빌드 작업을 수행하는 데 사용됩니다.
- **고성능 컴퓨팅(HPC)**: 과학적 시뮬레이션, 금융 분석, 유전체학 등 고성능 컴퓨팅 작업에 적합합니다.
- **웹 서버 및 애플리케이션 서버**: 트래픽 급증 시 스팟 인스턴스를 활용하여 웹 서버와 애플리케이션 서버의 용량을 확장할 수 있습니다.



#### 3.3.3 스팟 요청 (Spot Request)

- 스팟 요청은 스팟 인스턴스를 시작하기 위해 사용자가 AWS에 요청을 제출하는 프로세스입니다.
- 스팟 요청은 크게 두 가지 유형으로 나눌 수 있습니다:



**One-time Spot Request**

- 특정 시점에 단 한 번의 스팟 인스턴스를 요청합니다.
- 요청이 즉시 또는 이후에 충족되면, 스팟 인스턴스가 시작됩니다.
- 요청이 충족되지 않으면, 사용자가 수동으로 다시 요청을 제출해야 합니다.
- 단기적으로 필요한 컴퓨팅 자원을 확보하고자 할 때.



**Persistent Spot Request**

- 요청이 충족된 후에도 계속해서 유지되며, 인스턴스가 종료되거나 중단된 후 자동으로 다시 요청이 제출됩니다.
- AWS가 인스턴스를 종료하더라도 요청이 자동으로 재제출되어 새로운 스팟 인스턴스를 시작합니다.
- 사용자가 요청을 취소할 때까지 지속됩니다.
- 장기적으로 일정한 컴퓨팅 자원을 필요로 하는 경우.



#### 3.3.4 스팟 플릿 (Spot Fleet)

- [[SpotFleet]] 참고



### 3.4 전용 호스트 (Dedicated Host)

- [AWS 전용 호스트 설명서](https://aws.amazon.com/ec2/dedicated-hosts/)
- **물리적 서버의 전체 용량**: 전용 호스트는 하나의 물리적 서버 전체를 특정 고객에게 전용으로 할당합니다. 이 서버의 모든 리소스를 사용자가 독점적으로 사용할 수 있습니다.
- **기존 소프트웨어 라이선스 활용**: 사용자는 자신의 기존 소프트웨어 라이선스를 사용할 수 있습니다. 예를 들어, 특정 서버 기반 소프트웨어 라이선스가 필요하거나 BYOL(Bring Your Own License) 정책을 활용할 수 있습니다.
- **컴플라이언스 및 규제 요구 사항 충족**: 전용 호스트는 특정 컴플라이언스 규정(예: GDPR, HIPAA)을 준수해야 하는 경우에 적합합니다. 사용자는 하드웨어의 완전한 통제권을 가지며, 이를 통해 특정 규제 요구 사항을 충족할 수 있습니다.
- **고성능 컴퓨팅에 적합**: 높은 연산 능력과 메모리 용량이 필요한 고성능 컴퓨팅(HPC) 작업에 이상적입니다.
- **완전한 하드웨어 제어**: 사용자에게 전체 물리적 서버에 대한 제어권을 제공합니다. 따라서 하드웨어 수준의 설정과 최적화를 수행할 수 있습니다.
- **비용 및 관리의 복잡성**: 전용 호스트는 높은 비용이 들며, 물리적 하드웨어를 직접 관리해야 하기 때문에 관리의 복잡성도 증가합니다.
- **호스트 및 인스턴스 친화성**: 전용 호스트는 동일한 물리적 서버에 인스턴스를 지속적으로 배포할 수 있도록 지원합니다.
- **소켓, 코어 및 호스트 ID 가시성**: 전용 호스트는 소켓, 물리적 코어 수 및 호스트 ID에 대한 가시성을 제공합니다.



### 3.5 전용 인스턴스 (Dedicated Instances)

- [AWS 전용 인스턴스 설명서](https://aws.amazon.com/ec2/dedicated-instances/)
- **특정 고객에게 전용 할당**: 전용 인스턴스는 특정 고객에게 전용으로 할당된 하드웨어에서 실행됩니다. 동일한 서버에 있는 모든 전용 인스턴스는 같은 계정 소유자의 것입니다.
- **독립된 하드웨어 사용**: 전용 인스턴스는 동일한 계정 내의 다른 인스턴스와 하드웨어를 공유하지 않습니다. 따라서 다른 고객의 인스턴스와 하드웨어 자원을 공유하지 않습니다.
- **고도의 보안 요구**: 전용 인스턴스는 다른 인스턴스와 물리적 하드웨어를 공유하지 않기 때문에 보안 요구 사항이 높은 애플리케이션에 적합합니다.
- **높은 보안 및 성능**: 높은 보안 수준과 안정적인 성능을 제공합니다. 데이터 및 워크로드가 다른 고객과 완전히 분리되어 있습니다.
- **비용**: 전용 인스턴스는 표준 인스턴스보다 비용이 높습니다. 하지만 전용 호스트보다는 비용이 낮을 수 있습니다.
- **제어 및 가시성 부족**: 전용 인스턴스는 인스턴스 배치에 대한 가시성이나 제어를 제공하지 않으며, 호스트 친화성을 지원하지 않습니다.
- **BYOL 지원**: 전용 인스턴스는 제한된 BYOL 지원을 제공하며, 전용 호스트만큼의 유연성을 제공하지 않습니다.



**차이점 요약**

|**기능**|**전용 호스트**|**전용 인스턴스**|
|---|---|---|
|**자원 독점 정도**|전체 물리적 서버를 전용으로 사용|특정 고객에게 전용 할당된 하드웨어에서 실행되지만, 같은 서버에 다른 전용 인스턴스가 있을 수 있음. 이 모든 인스턴스는 동일한 계정 소유자의 것입니다.|
|**사용 사례**|높은 컴플라이언스 요구 사항, 기존 라이선스 활용, 고성능 컴퓨팅|고도의 보안 요구 사항, 데이터 분리|
|**비용**|더 높은 비용과 복잡한 관리|상대적으로 낮은 비용|
|**보안 및 제어**|전체 하드웨어에 대한 완전한 제어와 보안|높은 보안과 성능, 다른 고객과의 자원 분리|
|**소켓, 코어, 호스트 ID 가시성**|제공|제공하지 않음|
|**호스트 및 인스턴스 친화성**|지원|지원하지 않음|
|**BYOL 지원**|완전한 지원|제한적 지원|



### 3.6 세이빙 플랜

- 세이빙 플랜은 특정 기간 동안 일정 금액을 지불하기로 약정하면 다양한 인스턴스 타입과 리전에 걸쳐 할인된 요금을 적용받을 수 있는 요금제입니다.
- 예약 인스턴스와 달리 인스턴스 타입과 리전을 변경할 수 있는 유연성을 제공합니다.
- 다양한 인스턴스 유형과 리전을 사용하는 기업, 장기적인 비용 절감에 적합합니다.
- 높은 유연성과 비용 절감 효과를 제공합니다.
- 약정 기간 동안 일정 금액을 지불해야 하는 점이 있습니다.



#### 3.6.1 Compute Savings Plan

- **특징**
    - **유연성**: 인스턴스 유형, 리전, 운영체제(OS), 테넌시(전용 또는 공유) 등 다양한 인스턴스 속성을 변경할 수 있습니다.
    - **적용 범위**: 모든 EC2 인스턴스와 AWS Lambda, AWS Fargate에도 적용됩니다.
    - **자동 최적화**: AWS는 고객의 사용량에 맞춰 자동으로 최적의 비용 절감을 제공하도록 조정합니다.
    - **할인율**: 인스턴스 유형과 상관없이 일정한 할인율을 제공합니다.
- **적합한 사용 사례**
    - 다양한 인스턴스 유형과 리전에서 작업하는 유동적인 워크로드.
    - EC2, Fargate, Lambda를 혼합해서 사용하는 환경.
    - 특정 인스턴스나 리전에 구애받지 않고 유연하게 컴퓨팅 리소스를 사용하고자 하는 경우.



#### 3.6.2 EC2 Instance Savings Plan

- **특징**
    - **특정 인스턴스 패밀리 및 리전**: 특정 인스턴스 패밀리(예: M, C, R 등) 내에서 같은 리전의 모든 인스턴스 유형에 대해 할인된 요금을 제공합니다.
    - **제한된 유연성**: Compute Savings Plan에 비해 인스턴스 유형과 리전의 변경이 제한적입니다.
    - **적용 범위**: EC2 인스턴스에 적용되며, 특정 패밀리 내에서만 유효합니다.
    - **할인율**: Compute Savings Plan보다 조금 더 높은 할인율을 제공할 수 있습니다.
- **적합한 사용 사례**
    - 특정 인스턴스 패밀리 내에서 고정된 워크로드를 실행하는 경우.
    - 특정 리전에서 지속적으로 동일한 인스턴스 패밀리를 사용하는 경우.
    - 비용 절감을 최우선으로 하며 특정 워크로드에 최적화된 인스턴스를 선택할 수 있는 경우.



#### 3.6.3 Savings Plans 적용 서비스와 선택 가이드

- **Amazon EC2**
    - 모든 유형의 EC2 인스턴스에 대해 Savings Plans를 사용할 수 있습니다.
    - Compute Savings Plan은 인스턴스 유형이나 리전에 구애받지 않고 사용 가능하며, EC2 Instance Savings Plan은 특정 인스턴스 패밀리와 리전에 대해 더 높은 할인율을 제공합니다.
- **AWS Lambda**
    - Compute Savings Plan을 통해 비용 절감이 가능하며, 함수 호출 수와 실행 시간에 따라 할인됩니다.
- **AWS Fargate**
    - Compute Savings Plan이 적용되어 컨테이너 기반 애플리케이션을 경제적으로 운영할 수 있습니다.



**플랜 선택 팁**:

- **유연성 필요**: 다양한 인스턴스 유형과 리전에서 워크로드를 유연하게 운영하고자 한다면 Compute Savings Plan이 적합합니다.
- **비용 절감 우선**: 특정 인스턴스 패밀리와 리전에서 고정된 워크로드를 운영하며, 최대한의 비용 절감을 원한다면 EC2 Instance Savings Plan이 적합합니다.

  

## 4 퍼블릭 IP란

- **퍼블릭 IP**는 EC2 인스턴스에 할당되어 외부 인터넷과 통신할 수 있도록 해주는 고유한 IP 주소입니다.
- 인터넷 상에서 유일한 주소를 가지며, 다른 인스턴스나 디바이스와의 통신을 가능하게 합니다.
- 퍼블릭 IP의 종류는 동적 퍼블릭 IP와 탄력적 IP가 있습니다.



### 4.1 동적 퍼블릭 IP (Dynamic Public IP)

- EC2 인스턴스가 시작될 때 자동으로 할당되는 퍼블릭 IP입니다.
- 인스턴스가 중지되거나 종료되면 IP 주소가 해제됩니다.
- 인스턴스를 다시 시작하면 새로운 퍼블릭 IP가 할당됩니다.
- 짧은 시간 동안만 퍼블릭 IP가 필요한 경우에 유용합니다.



### 4.2 탄력적 IP (Elastic IP)

- 사용자가 고정된 퍼블릭 IP 주소를 할당하고 유지할 수 있는 옵션입니다.
- 인스턴스가 중지되거나 종료되더라도 IP 주소를 유지할 수 있습니다.
- 다른 인스턴스로 쉽게 재할당할 수 있어 장애 조치 시 빠르게 IP 주소를 이전할 수 있습니다.
- 고정된 IP 주소가 필요한 경우 유용합니다.
- 그러나 Elastic IP는 인스턴스에 연결되어 있지 않은 경우, 사용되지 않는 상태에서도 비용이 발생할 수 있습니다.
- 또한, AWS 계정당 할당 가능한 Elastic IP 주소 수에는 제한이 있습니다.
- 고정 IP 주소에 의존하는 설계는 클라우드 네이티브 아키텍처의 원칙과 맞지 않을 수 있습니다.



#### 4.2.1 Elastic IP의 대안

1. **Amazon Route 53**
    - Amazon Route 53은 고가용성 및 확장 가능한 DNS 웹 서비스입니다.
    - 인스턴스가 재시작되거나 IP 주소가 변경되더라도 도메인 이름을 통해 안정적으로 접근할 수 있습니다.
2. **Elastic Load Balancer (ELB)**
    - Elastic Load Balancer는 여러 인스턴스에 트래픽을 자동으로 분산시킵니다.
    - 이를 통해 특정 인스턴스에 의존하지 않고도 가용성과 확장성을 높일 수 있습니다.
3. **Auto Scaling**
    - Auto Scaling은 트래픽 변화에 따라 EC2 인스턴스 수를 자동으로 조정합니다.
    - 이를 통해 동적이고 유연한 리소스 관리가 가능하여 고정 IP 주소의 필요성을 줄일 수 있습니다.



## 5 Placement Group

- Amazon EC2의 Placement Group은 EC2 인스턴스의 배치를 최적화하여 네트워크 성능을 높이거나 가용성을 향상시키기 위한 기능입니다.
- Placement Group에는 클러스터 배치 그룹, 분산 배치 그룹, 파티션 배치 그룹의 세 가지 유형이 있습니다.



### 5.1 클러스터 배치 그룹 (Cluster Placement Group)

- 동일한 가용 영역 내에서 인스턴스를 논리적으로 묶어 높은 성능의 네트워크를 제공합니다.
- 대규모 데이터 처리 작업에 적합하며, 높은 대역폭과 낮은 지연 시간을 제공합니다.
- 가용 영역(AZ)에 장애가 발생하면 모든 인스턴스가 함께 장애를 겪을 수 있습니다.
- **사용 사례**:
    - 고성능 컴퓨팅(HPC) 애플리케이션
    - 대규모 데이터 분석 작업
    - 빅데이터 처리



### 5.2 분산 배치 그룹 (Spread Placement Group)

- 여러 가용 영역(AZ)에 걸쳐 인스턴스를 분산 배치하여 단일 하드웨어 실패로 인한 영향을 최소화합니다.
- 인스턴스 간의 물리적 격리를 제공합니다.
- 분산 배치 그룹은 각 인스턴스를 서로 다른 물리적 하드웨어에 배치하여 단일 하드웨어 장애 시 영향을 최소화합니다.
- 높은 가용성과 복원력을 제공합니다.
- 단일 하드웨어 실패뿐만 아니라, 가용 영역의 장애에도 영향을 받지 않도록 설계되었습니다.
- 가용 영역(AZ)마다 최대 7개의 인스턴스만 생성할 수 있습니다. 이는 대규모 배포에서는 제약이 될 수 있습니다.
- **사용 사례**:
    - 중요 애플리케이션 및 서비스
    - 민감한 데이터가 포함된 워크로드



### 5.3 파티션 배치 그룹 (Partition Placement Group)

- 인스턴스를 여러 파티션에 나누어 배치하여 파티션 간의 물리적 격리를 보장합니다.
- 파티션 간 격리로 인해 하나의 파티션이 실패하더라도 다른 파티션에 영향을 미치지 않습니다.
- 각 파티션 내의 인스턴스는 동일한 랙에서 실행됩니다.
- 파티션과 랙은 일대일 대응합니다.
- 가용 영역(AZ)마다 최대 7개의 파티션이 존재합니다.
- 파티션마다 여러 개의 인스턴스를 가질 수 있습니다.
- **사용 사례**:
    - 분산 데이터베이스
    - 분산 파일 시스템
    - 복잡한 빅데이터 워크로드


### 5.4 Placement Group의 장점

- **향상된 네트워크 성능**: 클러스터 배치 그룹을 통해 낮은 지연 시간과 높은 대역폭의 네트워크 성능을 달성할 수 있습니다.
- **높은 가용성**: 분산 배치 그룹과 파티션 배치 그룹은 하드웨어 실패로부터의 영향을 최소화하여 높은 가용성을 보장합니다.
- **유연한 배치 전략**: 워크로드 특성에 맞는 배치 전략을 선택할 수 있습니다.



## 6 EC2 Hibernate

- **EC2 Hibernate**는 Amazon EC2 인스턴스를 중지하고 나중에 다시 시작할 때 메모리(RAM)의 상태를 유지하는 기능입니다.
- 하이버네이트를 사용하면 인스턴스를 재부팅할 필요 없이, 기존 상태로 빠르게 복구할 수 있습니다.
- 이는 특정 워크로드에 유용하며, 특히 긴 초기화 시간이 필요한 애플리케이션에 적합합니다.
- 하이버네이트를 활성화하면 인스턴스가 중지될 때 메모리의 내용을 루트 EBS 볼륨에 저장합니다.
- 인스턴스를 다시 시작하면 메모리의 내용이 복원되어 애플리케이션이 중단된 지점에서 재개됩니다.
- 이는 EC2 인스턴스의 상태를 유지하면서도 인스턴스 재시작 시간을 단축시킵니다.
- 조건
    - 하이버네이트는 특정 인스턴스 유형에서만 지원됩니다. 일반적으로 t2, t3, m3, m4, m5, c3, c4, c5 등이 지원됩니다.
    - 하이버네이트를 사용하려면 루트 볼륨이 EBS 볼륨이어야 하며, 암호화되어 있어야 합니다.
- 사용 사례
    - 개발 및 테스트 환경에서 인스턴스를 자주 중지하고 시작할 때 하이버네이트를 사용하여 시간을 절약할 수 있습니다.
    - 장시간 실행되는 데이터 분석 작업을 중단 후 다시 시작할 때 유용합니다.
    - 초기화 시간이 긴 웹 애플리케이션의 상태를 유지하면서 비용을 절감할 수 있습니다.