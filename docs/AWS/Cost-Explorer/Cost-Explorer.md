## 1 AWS 비용 관리 개요

- AWS 클라우드를 사용하면서 비용 관리는 모든 기업에게 중요한 부분입니다.
- 효과적인 비용 관리를 위해서는 비용 할당 태그(Cost Allocation Tags)의 올바른 설정과 활성화가 필수적입니다.
- 이 가이드에서는 AWS의 비용 관리 도구들과 태그를 활용한 비용 추적 방법을 상세히 알아보겠습니다.



## 2 비용 할당 태그(Cost Allocation Tags) 이해하기

- 비용 할당 태그는 AWS 리소스에 대한 비용을 세부적으로 추적할 수 있게 해주는 도구입니다.
- AWS는 두 가지 유형의 비용 할당 태그를 제공합니다:
	- AWS 생성 태그: AWS에 의해 자동으로 생성되는 태그
	- 사용자 정의 태그: 사용자가 직접 생성하고 관리하는 태그



## 3 태그 활성화 프로세스

- 태그를 생성하는 것만으로는 비용 관리에 사용할 수 없습니다.
- 비용 할당 태그로 사용하기 위해서는 다음 단계가 필요합니다:
	- 1단계: AWS 리소스에 태그 적용
	- 2단계: Billing and Cost Management 콘솔에서 태그 활성화
	- 3단계: 태그 활성화 후 최대 24시간 대기
	- 4단계: Cost Explorer에서 태그 기반 보고서 생성 가능



## 4 태그 활성화 방법

### 4.1 AWS Management Console을 통한 활성화

**단계별 활성화 과정**

- 1. AWS Management Console에 로그인합니다.
- 2. Billing and Cost Management 콘솔로 이동합니다.
- 3. 왼쪽 탐색 창에서 'Cost Allocation Tags'를 선택합니다.
- 4. 사용자 정의 태그 섹션에서 활성화할 태그를 찾습니다.
- 5. '활성화' 버튼을 클릭하여 해당 태그를 비용 할당 태그로 활성화합니다.



### 4.2 AWS CLI를 통한 태그 활성화

**태그 활성화 명령어**

```bash
aws ce update-cost-allocation-tags-status \
    --cost-allocation-tags-status '[{"TagKey": "Environment", "Status": "Active"}]'
```

- 위 명령어는 'Environment' 태그를 비용 할당 태그로 활성화합니다.
- Status 값으로 'Active' 또는 'Inactive'를 사용할 수 있습니다.



## 5 태그 활성화 후 대기 시간

- 태그를 활성화한 후에는 Cost Explorer에서 사용하기까지 시간이 필요합니다
- 태그 활성화 후 최대 24시간의 처리 시간이 소요됩니다.
- 이미 적용된 태그의 경우, 다음 결제 주기부터 비용 데이터에 반영됩니다.
- 신규 리소스에 적용된 태그는 활성화 후 24시간 이내에 사용 가능합니다.



## 6 태그 활성화 상태 확인

### 6.1 콘솔에서 확인

- Billing and Cost Management 콘솔의 Cost Allocation Tags 페이지에서 확인 가능합니다:
- Status 열에서 각 태그의 현재 상태를 확인할 수 있습니다.
- 활성화된 날짜와 마지막 수정 일시도 확인 가능합니다.



### 6.2 AWS CLI를 통한 확인

**태그 상태 조회 명령어**

```bash
aws ce get-cost-allocation-tags
```

- 이 명령어는 모든 비용 할당 태그의 현재 상태를 반환합니다.
- 출력에는 태그 키, 상태, 활성화 시간 등이 포함됩니다.



## 7 Cost Explorer에서 태그 사용하기

- 활성화된 태그는 다음과 같은 방식으로 Cost Explorer에서 사용할 수 있습니다:
- 비용 분석을 위한 필터로 사용
- 그룹화 기준으로 사용
- 사용자 정의 보고서 생성 시 차원으로 활용



### 7.1 태그 기반 필터링

**필터링 방법**

- 1. Cost Explorer 콘솔에 접속합니다.
- 2. 필터 섹션에서 'Tag' 옵션을 선택합니다.
- 3. 사용할 태그 키와 값을 선택합니다.
- 4. 필터를 적용하여 특정 태그가 지정된 리소스의 비용만 확인합니다.



### 7.2 태그 기반 그룹화

- Cost Explorer에서 태그별로 비용을 그룹화하여 볼 수 있습니다:
- 'Group by' 옵션에서 태그를 선택합니다.
- 선택한 태그 값별로 비용이 그룹화되어 표시됩니다.
- 여러 태그를 조합하여 다차원 분석도 가능합니다.



## 8 태그 관리 모범 사례

### 8.1 태그 명명 규칙

- 일관된 태그 명명 규칙을 수립하고 준수합니다:
- 소문자를 사용하여 태그 키를 작성합니다.
- 일관된 구분자(예: 하이픈 또는 언더스코어)를 사용합니다.
- 의미가 명확한 태그 키와 값을 사용합니다.



### 8.2 필수 태그 정책

- 조직에 필요한 필수 태그를 정의하고 정책을 수립합니다:
	- 프로젝트 식별자
	- 비용 센터
	- 환경 구분(개발/스테이징/프로덕션)
	- 소유자 정보



### 8.3 자동화된 태그 적용

**AWS Organizations 태그 정책 예시**
```json
{
    "tags": {
        "CostCenter": {
            "tag_key": {
                "@@assign": "CostCenter"
            },
            "tag_value": {
                "@@assign": [
                    "Marketing",
                    "Sales",
                    "Engineering"
                ]
            }
        }
    }
}
```

- 위 정책은 조직 내 모든 계정에 대해 CostCenter 태그를 강제합니다.
- 허용된 값만 사용할 수 있도록 제한합니다.



## 9 비용 보고서 및 분석

### 9.1 Cost and Usage Report (CUR) 설정

- Cost and Usage Report를 통해 더 상세한 비용 분석이 가능합니다:
- 시간당 또는 일일 비용 세부 정보 확인
- 리소스 수준의 사용량 데이터 추적
- 태그별 비용 분석 수행



### 9.2 태그 기반 예산 설정

**AWS Budgets 설정 예시**

```json
{
    "BudgetName": "Development-Environment-Budget",
    "BudgetLimit": {
        "Amount": "1000",
        "Unit": "USD"
    },
    "TimeUnit": "MONTHLY",
    "CostFilters": {
        "TagKeyValue": [
            "user:Environment$Development"
        ]
    }
}
```

- 특정 태그가 지정된 리소스에 대한 예산을 설정할 수 있습니다.
- 예산 초과 시 알림을 설정할 수 있습니다.



## 10 태그 기반 비용 최적화

### 10.1 비용 분석

- 태그를 활용한 비용 분석 방법:
	- 프로젝트별 비용 추적
	- 부서별 비용 할당
	- 환경별(개발/스테이징/프로덕션) 비용 비교
	- 사용자별 리소스 사용량 모니터링



### 10.2 비용 최적화 전략

- 태그 기반 비용 최적화 전략:
	- 미사용 리소스 식별 및 제거
	- 과다 프로비저닝된 리소스 조정
	- 비용 효율적인 인스턴스 유형으로 마이그레이션
	- 예약 인스턴스 구매 결정을 위한 데이터 수집



## 11 결론

- AWS 비용 관리에서 태그의 올바른 설정과 활성화는 매우 중요합니다.
- 태그 활성화 후 데이터가 Cost Explorer에 반영되기까지 시간이 필요하다는 점을 인지해야 합니다.
- 체계적인 태그 정책과 모니터링을 통해 효율적인 비용 관리가 가능합니다.
- 정기적인 태그 감사와 업데이트를 통해 비용 관리 체계를 지속적으로 개선해야 합니다.