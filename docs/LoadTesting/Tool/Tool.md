---
title: "시스템 부하 테스트 도구의 이해와 활용"
description: "시스템 성능 테스트를 위한 부하 테스트 도구의 개념과 특징, 환경 구성 방법을 상세히 알아봅니다. 실제 시스템에서 부하 테스트를 수행할 때 고려해야 할 핵심 사항들을 다룹니다."
tags: ["PERFORMANCE_TESTING", "LOAD_TESTING", "APACHE_JMETER", "APACHE_BENCH", "LOCUST", "TSUNG", "TESTING", "DEVOPS"]
keywords: ["부하 테스트", "load test", "성능 테스트", "performance test", "부하 테스트 도구", "load testing tools", "아파치 벤치", "아파치 제이미터", "로커스트", "성능 테스트 환경", "시스템 부하", "시스템 성능"]
draft: false
hide_title: true
---

## 1. 부하 테스트의 기본 개념

부하 테스트는 시스템의 성능과 안정성을 검증하는 중요한 과정입니다. 이를 위해 다음과 같은 도구들이 사용됩니다:

- **부하 테스트 도구**: 시스템에 실제 부하를 발생시키는 도구
- **모니터링 도구**: 시스템 리소스 사용률을 가시화하는 도구
- **프로파일링 도구**: 미들웨어와 애플리케이션의 내부 동작을 분석하고 가시화하는 도구

## 2. 부하 테스트의 핵심 요소

### 2.1 Latency의 이해

부하 테스트 도구에서 보이는 Latency는 실제 시스템의 Latency와는 차이가 있습니다. 이는 다음과 같은 요소들이 포함되기 때문입니다:

- 네트워크로 전송되는 동안 발생하는 Latency
- SSL 프로토콜에 의한 추가 Latency
- 실제 시스템 처리 시간

:::info
각 시스템의 실제 Latency를 정확히 측정하기 위해서는 서버 프로그램을 보거나 로그 파일에서 실제 Latency를 확인해야 합니다.
:::

### 2.2 클라이언트 동시 처리의 중요성

부하 테스트 환경에서는 클라이언트 동시 가동 수와 실제 시스템에서 처리되는 동시 처리 수는 다를 수 있습니다. 특히 다음 사항들을 고려해야 합니다:

- 네트워크 Latency가 클 때는 부하 테스트 도구의 클라이언트 동시 가동 수와 비교하여 실제 처리 중인 요청 비율은 낮아질 수 있음
- 클라이언트 동시 가동 수를 적절히 조정하여 정확한 테스트 수행 필요

## 3. 부하 테스트 환경의 구성

### 3.1 서버와 네트워크의 차이

부하 테스트 환경에서는 다음과 같은 상황을 고려해야 합니다:

1. 서버 대수의 차이
	- 부하 테스트 서버: 1~N대
	- 서비스 환경: 요청을 한 수만큼 사용자가 존재

2. SSL 사용 시 고려사항
	- SSL 접속과 재산 처리 부하
	- 서비스 환경에서의 분산된 처리

:::warning
SSL 접속을 하지 않을 경우에도 HTTP 요청 때마다 통신을 끊고 다시 접속하게 되면 부하 테스트 서버에 과부하가 발생할 수 있습니다.
:::

### 3.2 DNS와 엔드포인트 처리

부하 테스트 환경과 서비스 환경에서의 DNS 처리 방식에 차이가 있습니다:

- **부하 테스트 환경**: DNS Lookup을 최소화하여 성능 최적화
- **서비스 환경**: 여러 엔드포인트에 분산되어 요청 처리

## 4. 동시 요청 수와 처리량

### 4.1 요청 처리의 특성

부하 테스트 환경에서는:
- 먼저 보내진 요청 결과가 부하 테스트 서버에 돌아올 때까지 기다림
- 동일한 요청을 보내게 됨

서비스 환경에서는:
- 특정 사용자 응답이 늦어져도 다른 사용자는 계속 새로운 요청을 생성
- 시스템 응답 시간이 늦어질수록 처리해야 할 동시 요청 수가 점점 증가

## 5. 부하 테스트 도구의 특징과 선택

### 5.1 주요 부하 테스트 도구

현재 많이 사용되는 부하 테스트 도구들은 다음과 같습니다:

- Apache Bench
- Apache JMeter
- Locust
- Tsung

각 도구는 특정 목적에 맞게 설계되어 있으며, 테스트 대상 시스템에 맞춰 적절한 도구를 선정해야 합니다.

### 5.2 높은 Throughput을 가진 시스템 부하 테스트

구축한 시스템 비기능적 요구 사항으로 높은 Throughput을 요구하는 경우, 높은 부하를 줄 수 있는 도구를 사용해야 합니다. 다음 도구들은 여러 대의 서버를 동시에 사용하여 부하 테스트를 수행할 수 있습니다:

- Locus
- JMeter
- Tsung

### 5.3 짧은 시간 부하를 주는 내구성 테스트

- Apache Bench는 수초~수분 범위의 부하 테스트에 적합하지만, 수십 분 이상 부하를 주기 위한 목적으로는 적합하지 않습니다.
- JMeter도 몇 시간 이상 부하를 줄 경우 테스트 중에 요청의 양이 줄어드는 현상이 발생하기도 합니다.

### 5.4 동시 사용자 수 개념

동시 사용자 수는 다음과 같은 여러 의미로 사용됩니다:

1. **동시 사용자 수(순간 수요의 총이)**
	- 시스템에 같은 시간에 사용 중인 사용자 수를 의미
	- 이 경우에는 1시간에 유니크한 사용자를 의미할 수도 있지만 1분간의 사용자를 의미할 수도 있어 조건을 확인해야 함

2. **피크 때 10,000명이 동시에 시스템을 사용**
	- 웹 서버나 데이터베이스 동시 접속 수(TCP 접속 수)
	- 시스템의 처리 성능과 관계없이 시스템과 연결된 TCP 접속 수를 의미

3. **시스템 동시 처리 수**
	- 시스템에서 현재 처리 중인 상태의 요청 수를 의미
	- 시스템 Throughput을 동시 처리 수로 사용하는 경우가 많지만, 실제로는 다른 의미를 가짐

:::info
동시 처리 수(req) = 평균 Throughput(req/sec) × 평균 Latency(sec)
:::

시스템의 Throughput이 높더라도 Latency가 낮으면 동시 처리 수는 작아질 수 있습니다. Throughput이 높은 시스템이지만, 동시 처리 수가 많은 상태는 Latency가 나쁜 상태인 경우가 많고 좋은 상태의 시스템과는 달라 보입니다.

:::tip
각 도구는 고유한 특징을 가지고 있으므로, 부하 테스트 대상이 되는 시스템에 맞춰 적절한 도구를 선정해야 합니다.
:::

## 6. 테스트 대상 시스템에 맞는 부하 테스트 도구 사용

### 6.1 테스트 도구 선정 시 고려사항

부하 테스트 목적에 따라 사용해야 하는 도구는 다릅니다. 예를 들어 아주 높은 Throughput을 제공해야 하는 시스템을 테스트하기 위해 Apache Bench를 사용하면 그 특성에 따라 충분한 부하를 주지 못할 때가 있습니다.

의식한 테스트 도구를 하나만 들이는 것도 중요한 일이지만, 테스트에 따라 성격에 맞는 도구를 선정하는 것도 중요합니다.

### 6.2 세션 ID와 패스워드 등 요청별로 다른 파라미터 사용

다음 2가지 방법이 있습니다:

1. 부하 테스트 대상 프로그램을 수정하여 파라미터를 사용하는 부분에 스텁(stub)을 하거나 프로그램 안에서 파라미터를 생성하여 넣어버리는 방법
2. 복잡한 테스트 시나리오로 실행이 가능한 도구를 사용하는 방법

:::tip
복잡한 테스트 시나리오로 실행이 가능한 도구의 예로서 Locust나 JMeter, Tsung 등이 있습니다.
:::

## 7. 실전 부하 테스트 수행 시 고려사항

1. 실제 환경과 유사한 테스트 환경 구성
2. 적절한 모니터링 도구 설정
3. 결과 데이터의 정확한 수집과 분석
4. 테스트 시나리오의 현실성 확보
5. 점진적인 부하 증가를 통한 시스템 한계 측정

:::note
온라인으로 URL을 입력해서 부하 테스트를 하는 서비스도 있지만, 네트워크 외부에 가까운 거리에서 테스트할 수 없어서 필요한 부하 테스트를 실행하기 어렵다는 점을 주의해야 합니다.
:::